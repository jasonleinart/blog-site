{% comment %}
<!-- Enhanced Structured Data for Articles, FAQs, and LLM Discovery -->
{% endcomment %}

{% if page.layout == 'post' %}
<!-- Article Schema for Blog Posts -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ page.title | escape }}",
  "description": "{{ page.description | strip_html | strip_newlines | escape }}",
  "image": {
    "@type": "ImageObject",
    "url": "{{ page.image.path | default: site.accent_image | absolute_url }}",
    "width": 1200,
    "height": 630
  },
  "author": {
    "@type": "Person",
    "name": "{{ site.data.authors[page.author].name | default: site.author.name | default: site.title }}",
    "url": "{{ site.url }}{{ site.baseurl }}/about/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.title }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.logo | default: '/assets/icons/icon-512x512.png' | absolute_url }}",
      "width": 512,
      "height": 512
    }
  },
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  "dateModified": "{{ page.last_modified_at | default: page.date | date_to_xmlschema }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.url | absolute_url }}"
  },
  "articleSection": "{{ page.categories | first | capitalize }}",
  "keywords": [{% for tag in page.tags %}"{{ tag }}"{% unless forloop.last %},{% endunless %}{% endfor %}],
  "wordCount": {{ content | strip_html | number_of_words }},
  "inLanguage": "{{ site.lang | default: 'en' }}",
  "url": "{{ page.url | absolute_url }}"
}
</script>

<!-- Breadcrumb Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ site.url }}{{ site.baseurl }}/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ page.categories | first | capitalize }}",
      "item": "{{ site.url }}{{ site.baseurl }}/{{ page.categories | first }}/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ page.title }}",
      "item": "{{ page.url | absolute_url }}"
    }
  ]
}
</script>

{% endif %}

{% comment %}
<!-- FAQ Schema - Add this to posts that contain FAQs -->
<!-- Usage: Add 'faq: true' to front matter and structure FAQs with ## Q: and ## A: -->
{% endcomment %}
{% if page.faq %}
{% assign faq_questions = content | split: '## Q:' %}
{% if faq_questions.size > 1 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {% for question in faq_questions offset:1 %}
    {% assign qa_parts = question | split: '## A:' %}
    {% if qa_parts.size == 2 %}
    {
      "@type": "Question",
      "name": "{{ qa_parts[0] | strip_html | strip_newlines | escape }}",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "{{ qa_parts[1] | strip_html | strip_newlines | escape }}"
      }
    }{% unless forloop.last %},{% endunless %}
    {% endif %}
    {% endfor %}
  ]
}
</script>
{% endif %}
{% endif %}

{% comment %}
<!-- Website/Organization Schema for Homepage -->
{% endcomment %}
{% if page.url == '/' or page.url == '/index.html' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ site.title }}",
  "description": "{{ site.description | strip_html | strip_newlines | escape }}",
  "url": "{{ site.url }}{{ site.baseurl }}/",
  "author": {
    "@type": "Person",
    "name": "{{ site.data.authors.author1.name | default: site.title }}",
    "url": "{{ site.url }}{{ site.baseurl }}/about/",
    "sameAs": [
      {% if site.data.authors.author1.social.github %}"https://github.com/{{ site.data.authors.author1.social.github }}",{% endif %}
      {% if site.data.authors.author1.social.twitter %}"https://twitter.com/{{ site.data.authors.author1.social.twitter }}",{% endif %}
      {% if site.data.authors.author1.social.linkedin %}"https://linkedin.com/in/{{ site.data.authors.author1.social.linkedin }}"{% endif %}
    ]
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ site.title }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ site.logo | default: '/assets/icons/icon-512x512.png' | absolute_url }}"
    }
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ site.url }}{{ site.baseurl }}/search/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
{% endif %}

{% comment %}
<!-- LLM Discovery Optimization Meta Tags -->
{% endcomment %}
{% if page.layout == 'post' %}
<!-- AI/LLM Discovery Meta Tags -->
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<meta name="article:published_time" content="{{ page.date | date_to_xmlschema }}">
<meta name="article:modified_time" content="{{ page.last_modified_at | default: page.date | date_to_xmlschema }}">
<meta name="article:author" content="{{ site.data.authors[page.author].name | default: site.title }}">
<meta name="article:section" content="{{ page.categories | first }}">
{% for tag in page.tags %}
<meta name="article:tag" content="{{ tag }}">
{% endfor %}

<!-- Content Classification for AI -->
<meta name="content-type" content="article">
<meta name="content-category" content="{{ page.categories | first }}">
<meta name="reading-time" content="{{ content | strip_html | number_of_words | divided_by: 200 }} minutes">
<meta name="word-count" content="{{ content | strip_html | number_of_words }}">

<!-- AI Training Friendly Metadata -->
<meta name="ai-content-summary" content="{{ page.description | strip_html | strip_newlines | escape }}">
<meta name="ai-content-topics" content="{{ page.tags | join: ', ' }}">
<meta name="ai-content-expertise-level" content="intermediate">
<meta name="ai-content-format" content="blog-post">
{% endif %}